---
title: "Relational Algebra"
sidebar:
  order: 4
---

To sum up what we have learned in the preceding two sections (about [Algebraic structures](/ra-primer/algebra) and [Relations](/ra-primer/relations):

* Relational algebra consists of a number of operations
* These operations are defined over relations
* A relation is a set of tuples 
* A table in a relational database defines a relation extensionally, ie by explicitly listing tuplesfor which the relation holds

## Example relations in JSON

To demystify all of this, let's consider two JSON objects:

##### My friends
```json
[
  { "name": "Emily", "yearsKnown": 10 },
  { "name": "Stanisław", "yearsKnown": 15 }
  { "name": "Juan", "yearsKnown": 32 },
  { "name": "Ali", "yearsKnown": 27 }
]
```

##### Your friends
```json
[
  { "name": "Aisha", "yearsKnown": 35 },
  { "name": "Belle", "yearsKnown": 17 },
  { "name": "Stanisław", "yearsKnown": 2 }
]
```

We can view each of the objects as a tuple with two attributes, and each array as an extensional definition of a relation. There is another important aspect of this representation: the attributes have a name and a type. In this case, each tuple have an attribute `name` of type string and an attribute `yearsKnown` of type integer.

So here we have two relations: **My friends** and **Your friends.**. Now, let's say we're planning a party and want to invite both my friends and yours. How do we find out who to invite? By combining our friend relations, of course! To do that, we introduce our very first operation from relational algebra: **Union** (**∪**).

*My friends* **∪** *Your friends*

Or in pseudocode:

```javascript
union(myFriends, yourFriends)
```

The result is a new relation:

```json
[
  { "name": "Emily", "yearsKnown": 10 },
  { "name": "Stanisław", "yearsKnown": 15 }
  { "name": "Juan", "yearsKnown": 32 },
  { "name": "Ali", "yearsKnown": 27 }
  { "name": "Aisha", "yearsKnown": 35 },
  { "name": "Belle", "yearsKnown": 17 },
  { "name": "Stanisław", "yearsKnown": 2 }
]
```

Note that **Union** is only possible between relations which are union-compatible, ie their tuples have the same number of attributes, with the same names (and types, also called *domains*).

There is a problem here, of course, because Stanisław is now included twice. A very important fact about relations is that they are *sets*, in the mathematical sense, and therefore never contain more than one instance of each tuple. But since the two Stanisław tuples are different, because they do not have the same value for `yearsKnown`, they are both included.

We would like to get rid of the `yearsKnown` attribute, and to do that we use another operator: **projection** (**π**), which lets us select which attributes we want from a relation.

**π**(*name*)(*My friends* **∪** *Your friends*)

Pseudocode:

```javascript
project(["name"], union(myFriends, yourFriends))
```

```json
[
  { "name": "Emily" },
  { "name": "Stanisław" }
  { "name": "Juan" },
  { "name": "Ali" }
  { "name": "Aisha" },
  { "name": "Belle" },
]
```

Now everyone is included only one time.

:::note
The corresponding query in SQL will **not** remove the duplicate tuple, because tables in SQL do not have set semantics and thus are not true relations. 
:::

Note that we could rewrite this expression as:


**π**(*name*) *My friends*  **∪**  **π**(*name*) *Your friends* 

Pseudocode:

```javascript
union(
  project(["name"], myFriends),
  project(["name"], yourFriends)
)
```

This is not very interesting in itself, but gives a first taste of the algebraic flavor of relational algebra. **Project** *distributes over* **Union** in the same way that multiplication distributes over addition: *a(b+c) = ab + ac*.

## Tables, headers and rows 

Let's now move on from JSON and settle on the standard way of talking about relations. As we have seen, a relation is a set of tuples, and those tuples must all share the same number of attributes, which must have the same names and domains. The usual way of visualizing this is as a table:

| Name : String | YearsKnown : Integer |
| ------------- | -------------------- |
| Emily         | 10                   |
| Stanisław     | 15                   |
| ...           | ...                  |

The *header* of the table defines the names of the attributes and their domains (or types). Each row represents a tuple and each column lists one attribute of the tuples.

Every operation of relational algebra takes one or two relations as input and produces a new relation. The new relation will sometimes have the same header as the input relation(s), but more often it will produce a new header. Of the examples we have seen above, **Union** preserves the headers of the input relations, whereas the header of **Project** will only contain the attributes that were specified.

In what follows, we will assume that the following relations are defined:

##### Actor

| Name : String | YearBorn : Integer |
| ------------- | ------------------ |
| Jennifer Jason Leigh | 1962 |
| Peter Sellers | 1925               |
| Robin Williams| 1949               |
| Shelley Duval | 1949               |

##### Role 

| ActorName : String | Name : String | FilmName : String |
| ------------------ | ------------- | ----------------- |
| Jennifer Jason Leigh | Lois Kaiser | Short Cuts |
| Jennifer Jason Leigh | Pauline Avery | In the Cut |
| Peter Sellers | Dr. Strangelove | Dr. Strangelove |
| Peter Sellers | Inspector Jacques Clouseau | The Pink Panther |
| Robin Williams | Henry Sagan| The Fisher King |
| Robin Williams | Popeye | Popeye |
| Shelley Duval | Olive Oyl | Popeye |
| Shelley Duval | Wendy Torrance| The Shining |

##### Film

| Name : String | ProductionYear : Integer | Director : String |
| ------------- | ------------------------ | ----------------- |
| Dr. Strangelove | 1964 | Stanley Kubrik |
| Fast Times at Ridgemont High | 1982 | Amy Heckerling |
| In the Cut | 2003 | Jane Campion |
| Popeye      | 1980 | Robert Altman |
| Short Cuts | 1993 | Robert Altman |
| The Fisher King | 1991 | Terry Gilliam |
| The Pink Panther | 1963 | Blake Edwards |
| The Shining | 1980 | Stanley Kubrik |

With this, we are ready to look at a few other fundamental operations of relational algebra.

## Select


















